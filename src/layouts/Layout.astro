---
import Header from "@components/Header.astro";
import "@fontsource/be-vietnam-pro";
import "@fontsource-variable/gabarito";
import Footer from "@components/Footer.astro";
import type { SiteConfig, Lang } from "@types";

interface Props {
  siteConfig: SiteConfig;
  currentLang: Lang;
}

const { siteConfig, currentLang } = Astro.props;

const {
  title,
  description,
  siteLogo,
  navLinks,
  lang,
  author,
  socialLinks,
  canonicalURL = new URL(Astro.url.pathname, Astro.site).href,
} = siteConfig;

const baseUrl = Astro.site?.href || "https://astro-zen.vercel.app";
const esUrl = baseUrl;
const enUrl = baseUrl + "en/";
---

<!doctype html>
<html lang={lang} class="scroll-pt-16 scroll-smooth">
  <head>
    <!-- Theme script (must be first to prevent flash) -->
    <script is:inline>
      // Prevent flash of wrong theme
      (function() {
        const theme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (theme === 'light' || (!theme && !prefersDark)) {
          document.documentElement.classList.add('light');
        }
      })();
    </script>

    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="author" content={author} />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>

    <!-- Canonical and alternate language links -->
    <link rel="canonical" href={canonicalURL} />
    <link rel="alternate" hreflang="es" href={esUrl} />
    <link rel="alternate" hreflang="en" href={enUrl} />
    <link rel="alternate" hreflang="x-default" href={esUrl} />

    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:locale" content={currentLang === "es" ? "es_ES" : "en_US"} />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
  </head>
  <body class="font-sans bg-theme-primary">
    <Header siteLogo={siteLogo} navLinks={navLinks} currentLang={currentLang} />
    <main>
      <slot />
    </main>
  </body>
</html>
